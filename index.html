<!DOCTYPE html>
<html lang="en" dir="auto" prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>Tuwa - Web Player</title>
    <meta name="application-name" content="Tuwa">
    <meta name="apple-mobile-web-app-title" content="Tuwa">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Listen to premium content with distraction-free viewing. A brand of Tuwa Media.">
    <meta name="author" content="Tuwa Media">
    <link rel="manifest" href="manifest.json">
    <link type="text/plain" rel="author" href="humans.txt" />

    <meta property="og:site_name" content="Tuwa">
    <meta property="og:title" content="Tuwa - Web Player: Sight for everyone">
    <meta property="og:description" content="Listen to premium content with distraction-free viewing. A brand of Tuwa Media.">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://Quran-lite.pages.dev/social-preview.png"> 
    <meta property="og:image" content="assets/og-image.jpg"> <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Tuwa",
      "alternateName": "Tuwa Audio",
      "headline": "Sight for everyone",
      "operatingSystem": "Web, iOS, Android",
      "applicationCategory": "MusicApplication",
      "genre": "Music & Audio",
      "description": "Premium content platform with distraction-free viewing. A brand of Tuwa Media.",
      "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD",
    "availability": "https://schema.org/InStock"
  },
      "author": {
        "@type": "Organization",
        "name": "Tuwa Media",
        "url": "https://www.Quran-lite.pages.dev"
      },
      "copyrightHolder": {
        "@type": "Organization",
        "name": "Tuwa Media"
      },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.8",
    "ratingCount": "32000000"
  },
  "downloadUrl": "https://www.Quran-lite.pages.dev/download"
}
    }
    </script>
<script>
window.addEventListener('DOMContentLoaded', () => {
    // Check for "chapter" in the URL (handles ?chapter= and ?chapter)
    const urlParams = new URLSearchParams(window.location.search);
    
    if (urlParams.has('regex')) {
        const brandElements = document.querySelectorAll('.app-brand');
        
        brandElements.forEach(el => {
            // Using !important to override the 'display: flex' in your CSS
            el.style.setProperty('display', 'none', 'important');
        });
        
        // Optional: Console log to verify it triggered
        console.log('Chapter detected: .app-brand hidden.');
    }
});
</script>
    
    <link rel="canonical" id="dynamic-canonical" href="https://Quran-lite.pages.dev">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://everyayah.com">
    <link rel="preconnect" href="https://raw.githubusercontent.com">
    <link rel="icon" type="image/png" sizes="128x128" href="assets/ui/web.png">
<link rel="shortcut icon" href="assets/ui/web.ico">
<link rel="apple-touch-icon" href="assets/ui/apple-touch-icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Amiri:wght@400;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    </noscript>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
    <script src="src/ui/error-handling-img.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PDWXFDCQRH"></script>
    <link id="main-css" rel="stylesheet" href="styles/index1.css" fetchpriority="high">
    <link id="custom-select-css" rel="stylesheet" href="styles/custom-select.css" fetchpriority="high"> <link rel="stylesheet" href="styles/arabic-modal.css">
    <link rel="stylesheet" href="styles/user-select.css">
    <link rel="stylesheet" href="styles/inline-styles.css">
    <script src="src/utils/i18n-loader.js"></script>
    <script src="src/utils/analytics.js"></script>
    <script src="src/utils/github-redirect.js"></script>
<script> 
(function() {
    const css = `
      #_universal_loader {
        position: fixed;
        top: 0; left: 0; width: 100vw; height: 100vh;
        background-color: #000000;
        z-index: 2147483647;
        opacity: 1;
        /* Background fades out slightly slower so we see the light show */
        transition: opacity 0.8s ease-out 0.2s; 
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
       
      .wave-container {
        position: relative;
        width: 100%;
        max-width: 600px;
        height: 9000000000000000000000000000000px;
        transform-origin: center center;
        /* The Zoom Transition:
           We use a cubic-bezier that starts slow and snaps fast (The "Punch")
        */
        transition: 
            transform 1.0s cubic-bezier(0.7, 0, 0.3, 1), 
            filter 1.0s ease-in, 
            opacity 1.0s ease-in;
        will-change: transform, filter, opacity;
      }

      /* --- THE BOMBASTIC EXIT STATE --- */
      #_universal_loader.loaded .wave-container {
        transform: scale(15); /* Infinite Zoom */
        /* COMBINATION OF EFFECTS:
           1. Blur: Simulates extreme speed
           2. Brightness 600%: The "Flash" (Light Source)
           3. Drop-shadow: Adds the glowing aura
        */
        filter: blur(8px) brightness(90000%) drop-shadow(0 4px 30px rgba(0,0,0,1));
        opacity: 0.8;
        color: #000000;
      }

      /* --- WARP SPEED ACCELERATION --- */
      /* When loaded, we override the animation duration to be incredibly fast (0.2s) */
      #_universal_loader.loaded .wave1 { animation: wave_loop 0.2s linear infinite !important; }


      .wave-svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 200%;
        height: 100%;
        fill: none;
        stroke-width: 4;
        stroke-linecap: round;
        overflow: visible;
      }

      /* Normal Speed Settings */
      .wave1 { 
          stroke: #fff; 
          opacity: 0.7; 
          animation: wave_loop 4s linear infinite;
          filter: blur(2px) drop-shadow(0 4px 30px rgba(0,0,0,1));
      }


      @keyframes wave_loop {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); }
      }

      #_universal_loader.loaded {
        opacity: 0;
        pointer-events: none;
      }
    `;

    const style = document.createElement('style');
    style.appendChild(document.createTextNode(css));
    document.head.appendChild(style);

    const overlay = document.createElement('div');
    overlay.id = '_universal_loader';
    
    const container = document.createElement('div');
    container.className = 'wave-container';

    const wavePath = "M0,100 C150,180 350,20 500,100 C650,180 850,20 1000,100 C1150,180 1350,20 1500,100 C1650,180 1850,20 2000,100";

    const createWave = (cls) => {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("viewBox", "0 0 1000 200");
        svg.setAttribute("preserveAspectRatio", "none");
        svg.setAttribute("class", `wave-svg ${cls}`);
        
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", wavePath);
        svg.appendChild(path);
        return svg;
    };

    container.appendChild(createWave('wave1'));

    
    overlay.appendChild(container);
    document.documentElement.appendChild(overlay);

    function revealPage() {
        overlay.classList.add('loaded');
        // Wait for the 1.0s zoom/flash to finish before removing from DOM
        setTimeout(() => {
            if (overlay.parentNode) overlay.parentNode.removeChild(overlay);
        }, 2200); 
    }

    // --- NEW LOGIC START ---
    // Wrapper to handle URL check
    function checkAndReveal() {
        // Check if URL contains '?' (e.g. yyy.com/? or yyy.com?param=1)
        if (window.location.href.indexOf('?') > -1) {
            // Add extra 3 seconds throttle
            setTimeout(revealPage, 1000);
        } else {
            // No '?', reveal normally
            revealPage();
        }
    }

    if (document.readyState === 'complete') {
        checkAndReveal();
    } else {
        window.addEventListener('load', checkAndReveal);
        // Fallback: Force reveal after 8 seconds (passing through check)
        setTimeout(checkAndReveal, 8000);
    }
    // --- NEW LOGIC END ---

})();
</script><script>
  document.addEventListener("DOMContentLoaded", function() {
      // --- CONFIGURATION ---
      const storageKey = 'saved_h1_data'; 
      const targetH2Id = 'doors-hero-title'; 

      // --- HELPER: SAVE AND UPDATE ---
      function syncH1toH2() {
          // 1. Find the current H1 (fresh search every time)
          const currentH1 = document.querySelector('h1');
          const targetH2 = document.getElementById(targetH2Id);
          
          // 2. If we have an H1, save its data
          if (currentH1) {
              const newText = currentH1.innerText.trim();
              
              // Only update if it's actually different to avoid infinite loops
              if (newText && newText !== localStorage.getItem(storageKey)) {
                  localStorage.setItem(storageKey, newText);
                  if (targetH2) targetH2.innerText = newText;
              }
          }
      }

      // --- STEP 1: RESTORE IMMEDIATELY ---
      // Check memory instantly so H2 is not empty on load
      const savedData = localStorage.getItem(storageKey);
      const targetH2 = document.getElementById(targetH2Id);
      if (savedData && targetH2) {
          targetH2.innerText = savedData;
      }

      // --- STEP 2: WATCH THE WHOLE BODY ---
      // We observe 'document.body' so we catch the H1 even if it gets deleted/swapped.
      const observer = new MutationObserver(function(mutations) {
          // Whenever ANYTHING changes in the body, check if we need to sync H1
          syncH1toH2();
      });

      // Start watching everything (Text changes, new elements, etc.)
      observer.observe(document.body, { 
          childList: true, 
          subtree: true, 
          characterData: true 
      });
      
      // Run once at start to catch dynamic H1s that load fast
      syncH1toH2();
  });
</script>



    </head>
<body>
<a href="/" class="app-brand" aria-label="Tuwa Home">
    <div class="brand-icon">
        <img src="assets/ui/logo.png" alt="Tuwa Logo">
    </div>
    <span class="brand-text">Tuwa</span>
</a>

    <script src="src/utils/resolution.js"></script>
    <script src="src/components/recommendations.js"></script>
    <script src="src/components/offline-status.js"></script>
    <script src="src/utils/service-worker-registration.js"></script>
<div id="island-search-wrapper">
    <div class="island-search-box">
        <div class="search-icon-wrapper">

        </div>
        <input type="text" id="island-input" placeholder="Search anything" autocomplete="off">
    </div>

    <button id="island-trigger" class="enter-trigger" tabindex="0">
        <span class="key-hint" data-key="Enter">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>
            </svg>
    </button>
</div>

    <nav id="tv-sidebar">
        <a href="#" class="nav-item active" id="nav-home" tabindex="1">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            <span class="nav-label" data-i18n="nav.home">Home</span>
        </a>
        <a href="#" class="nav-item" id="nav-search" tabindex="2">
            <svg class="nav-icon" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
            <span class="nav-label" data-i18n="nav.search">Search</span>
        </a>
        <a href="../" class="nav-item" id="nav-profile" tabindex="3">
            <div class="nav-icon profile-icon">Q</div>
            <span class="nav-label" data-i18n="nav.profile">Profile</span>
        </a>
    </nav>

    <div id="search-overlay">
        <div class="keyboard-section">
            <div id="voice-search-btn" tabindex="0" role="button" data-i18n-aria-label="search.voiceSearch" aria-label="Voice Search">
                <svg viewBox="0 0 24 24"><path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/><path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/></svg>
            </div>
            <div id="search-input-display"></div>
            <div class="keyboard-grid" id="keyboard-grid"></div>
        </div>
        <div class="results-section">
            <div class="row-header row-header-top-results" data-i18n="dashboard.topResults">Top Results</div>
            <div class="results-grid" id="search-results-grid">
                <div class="no-results" data-i18n="dashboard.useKeyboard">Use the keyboard to describe a topic...</div>
            </div>
        </div>
    </div>



    <div id="dashboard-view" class="active">
        <div class="hero-banner">
            <div class="hero-preview-layer" id="hero-preview-layer">
                <img id="preview-img" class="preview-img" src="" alt="">
            </div>
            <div class="hero-shadow-overlay"></div>
            <div id="hero-subtitle-overlay"></div>

            <div class="hero-content">

                <h1 class="hero-title-text" id="door-hero-title" data-i18n="hero.title"></h1>
                <div class="hero-subtitle" id="door-hero-subtitle" data-i18n="hero.subtitle"></div>
                    
                        <path d="M18.25 12L7.75 5.75V18.25L18.25 12Z" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="row-section row-section-hidden" id="continue-section">
            <div class="row-header" data-i18n="dashboard.continueListening">Continue Listening</div>
            <div class="card-scroller" id="continue-row"></div>
        </div>


        <div class="row-section row-section-padding-bottom">
            <div class="row-header"></div>
            <div class="card-scroller" id="all-row"></div>
        </div>
    </div>

    <audio id="preview-audio" crossorigin="anonymous"></audio>

    <div id="cinema-view">
        <div id="loading-overlay">
            <nav id="splash-footer">

                <h2 class="heroz-title-text" id="doors-hero-title"></h2>
            </nav>
            <div class="loader-content">
                <div class="loader-spinner"></div>
                <div class="loader-text" id="loader-text"></div>
                <button id="start-btn" class="start-btn" data-i18n="player.start">Start</button>
            </div>


        </div>

        <div class="container">
            <audio id="audio-player" crossorigin="anonymous"></audio>
            <audio id="translation-audio-player" crossorigin="anonymous"></audio>

            <h1 id="chapter-title" data-i18n="player.title"></h1>
            
            <div id="content-display">
                <div id="verse-container">
                    <div id="buffering-indicator"></div>
                    <img id="verse-text" class="active-verse-img" alt="Verse" width="600" height="300" loading="eager">
                    <img id="verse-text-next" alt="Next Verse" width="600" height="300" loading="lazy">
                </div>
                <div id="translation-text" dir="auto" data-i18n="loading.selectSurah">Select a Surah...</div>
            </div>
        </div>

        <div id="control-panel">
            <div id="chapterSelectWrapper" class="custom-select-wrapper">
                <button class="custom-select-trigger" tabindex="0" data-i18n="player.selectSurahButton"><span>Select Surah</span></button>
                <div class="custom-options"></div>
            </div>
            
            <div id="verseSelectWrapper" class="custom-select-wrapper">
                <button class="custom-select-trigger" tabindex="0" data-i18n="player.ayah"><span>Ayah</span></button>
                <div class="custom-options"></div>
            </div>

            <div id="reciterSelectWrapper" class="custom-select-wrapper">
                <button class="custom-select-trigger" tabindex="0" data-i18n="player.reciter"><span>Reciter</span></button>
                <div class="custom-options"></div>
            </div>

            <div id="translationSelectWrapper" class="custom-select-wrapper">
                <button class="custom-select-trigger" tabindex="0" data-i18n="player.translation"><span>Translation</span></button>
                <div class="custom-options"></div>
            </div>

            <div id="translationAudioSelectWrapper" class="custom-select-wrapper">
                <button class="custom-select-trigger" tabindex="0" data-i18n="player.audioTrans"><span>Audio Translation</span></button>
                <div class="custom-options"></div>
            </div>
        </div>
    </div>

    <div id="arabic-modal">
        <div class="arabic-modal-card">
            <h2><b data-i18n="arabicModal.question">Do you know how to read Arabic?</b></h2>
            <h3 data-i18n="arabicModal.subtitle">Or you'll simply see only the translation.</h3>
            <div class="arabic-btn-group">
                <button id="btn-arabic-yes" class="arabic-btn" data-i18n="arabicModal.yes">Yes</button>
                <button id="btn-arabic-no" class="arabic-btn" data-i18n="arabicModal.no">No</button>
            </div>
        </div>
    </div>
    <script src="src/core/app.js"></script>
    <script src="src/core/ai-override.js"></script> 
    <script src="src/components/navigation.js"></script> <script src="src/components/arabic-modal-handler.js"></script>
    <script src="src/components/search/voice-search-bridge.js"></script>
    <script src="src/utils/content-protection.js"></script>
    <script src="src/components/search/grid-navigation.js"></script>
    <script src="src/ui/artifact.js"></script>
    <script src="src/ui/all-text-fade.js"></script>
    <div id="transition-fade-layer"></div>
<div id="premium-landing" style="display: none;"> 
    <div class="premium-brand-replica">
        <img src="assets/ui/logo.png" alt="Tuwa Logo">
        <span>Tuwa</span>
    </div>

    <div class="premium-content">
        <a href="/" class="appx-brand" aria-label="Tuwa Home">
            <div class="brand-icon">
                <img src="assets/ui/logo.png" alt="Tuwa Logo">
            </div>
            <span class="brand-text">Tuwa</span>
        </a>
        <h1 class="premium-title">Access to premium content with distraction-free viewing.</h1>
<p class="premium-subtitle">Premium streaming platform — <b>1.5 billion listeners daily</b></p>

<div class="premium-card-wrapper">
    <div class="premium-price-tag">
        <span class="price-period"></span>
        
        <span class="price-big">USD 0</span> 
        
        <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 4px;">
            <span class="price-term-common" style="color: #fff;">Premium Plan • <b>12 Months</b> (Limited time offer)</span>
            <span class="price-term-common"></span>
        <button id="premium-start-btn" class="premium-btn">Start watching for free</button>
 <nobr><span class="price-term">No credit card needed</span></nobr>
        </div>
    </div>
</div>


        
        <p class="premium-legal-disclaimer">
            *Promotional pricing of USD 0/mo valid for the initial 12-month term. Plan automatically continues at the standard zero-cost rate thereafter. No commitment; cancel anytime. No payment method required.
        </p>
    </div>

    <div class="premium-processing">
        <div class="premium-loader"></div>
        <div class="premium-status-text" id="premium-status">Confirming availability</div>
    </div>


<div id="legal-overlay" class="legal-backdrop">
    <div class="legal-glass-panel">
        <button class="legal-close" onclick="closeLegal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"></path></svg>
        </button>
        <div id="legal-content-area" class="legal-scroll-content">
            </div>
    </div>
</div>
<style>
/* --- LEGAL OVERLAY SYSTEM --- */
.legal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9995; /* Above everything, below Anti-Tamper cursor blockers if any */
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s var(--transition-smooth);
    display: flex;
    align-items: center;
    justify-content: center;
}

.legal-backdrop.active {
    opacity: 1;
    pointer-events: all;
}

.legal-glass-panel {
    width: 90%;
    max-width: 600px;
    height: 80vh;
    background: var(--glass-surface, rgba(20, 20, 20, 0.6));
    border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.1));
    border-radius: var(--radius-lg, 24px);
    box-shadow: 0 40px 80px rgba(0,0,0,0.8);
    transform: scale(0.95) translateY(20px);
    transition: transform 0.5s var(--transition-smooth);
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.legal-backdrop.active .legal-glass-panel {
    transform: scale(1) translateY(0);
}

.legal-scroll-content {
    padding: 40px;
    overflow-y: auto;
    color: var(--text);
    font-family: "Plus Jakarta Sans", sans-serif;
    font-size: 1.4rem;
    line-height: 1.8;
}

.legal-scroll-content h2 {
    font-size: 2.4rem;
    margin-bottom: 2rem;
    color: #fff;
    font-weight: 700;
    letter-spacing: -1px;
}

.legal-scroll-content p {
    margin-bottom: 1.5rem;
    color: rgba(255, 255, 255, 0.7);
}

.legal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(255,255,255,0.1);
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
    z-index: 10;
}

.legal-close:hover { background: rgba(255,255,255,0.25); }

/* MATCHING YOUR SCROLLBAR HIDING PREFERENCE */
.legal-scroll-content::-webkit-scrollbar { display: none; }
.legal-scroll-content { -ms-overflow-style: none; scrollbar-width: none; }
</style>
<script>
const legalData = {
    privacy: `
        <h2>Privacy Policy</h2>
        <p><strong>Effective Date: 2026</strong></p>
        <p>Tuwa Media is committed to "Sight for everyone" while respecting user's digital footprint. This minimal-collection policy ensures your streaming experience remains private.</p>
        <p><strong>1. Data We Collect</strong><br>We only collect necessary data for streaming stability and experience.</p>
        <p><strong>2. Third-Party Analytics</strong><br>No personally identifiable information (PII) is bridged to these sessions.</p>
    `,
    terms: `
        <h2>Terms of Use</h2>
        <p><strong>1. License to Access</strong><br>By accessing Tuwa (OpenTuwa.com - Tuwa Audio), you are granted a limited, non-exclusive license to stream content for personal use.</p>
        <p><strong>2. Anti-Tamper Mechanism</strong><br>This platform is protected by proprietary integrity checks. Attempting to bypass the overlay, inject styles, or manipulate the system constitutes a violation of these terms and will result in immediate access termination.</p>
        <p><strong>3. Intellectual Property</strong><br>All assets, and the "Tuwa", "OpenTuwa" and "Tuwa Audio" brand assets are the exclusive property of Tuwa Media and its partners.</p>
    `,
    cookies: `
        <h2>Cookie Preferences</h2>
        <p>We use a "Strictly Necessary" architecture.</p>
        <p><strong>Essential Cookies:</strong> No user's personal informations are stored.</p>
    `,
    corporate: `
        <h2>Corporate Information</h2>
        <p><strong>Tuwa Media</strong><br>Copyright (C) 2024-2026<br></p>
        <p><strong>Contact:</strong> legal@tuwamedia.com</p>
    `,
    compliance: `
        <h2>Regulatory Compliance</h2>
        <p><strong>GDPR / CCPA</strong><br>As a privacy-first platform, Tuwa Media (OpenTuwa.com) processes data on a legitimate interest basis. You retain the right to request local data erasure by clearing your browser cache.</p>
        <p><strong>Audio Standards</strong><br>Our streaming conforms to standard loudness normalization protocols (-14 LUFS) to ensure auditory safety during prolonged listening.</p>
    `
};

function openLegal(type) {
    const overlay = document.getElementById('legal-overlay');
    const content = document.getElementById('legal-content-area');
    
    // 1. Inject Content
    content.innerHTML = legalData[type] || "<h2>Content Unavailable</h2>";
    
    // 2. Reveal Overlay
    overlay.classList.add('active');
}

function closeLegal() {
    document.getElementById('legal-overlay').classList.remove('active');
}

// Close on backdrop click
document.getElementById('legal-overlay').addEventListener('click', (e) => {
    if (e.target === document.getElementById('legal-overlay')) closeLegal();
});
</script>

<!-- 1. LOAD SUPABASE SDK -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- 2. INJECT LOGIN STYLES (Keeps your vibe) -->
<style>
    /* Hybrid Auth Form Styles - Matches your Glassmorphism */
    #hybrid-auth-modal {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8); z-index: 2147483647;
        display: none; justify-content: center; align-items: center;
        backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        opacity: 0; transition: opacity 0.3s ease;
    }
    #hybrid-auth-modal.visible { opacity: 1; pointer-events: all; }
    
    .auth-card {
        background: rgba(20, 20, 20, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 24px; padding: 40px; width: 90%; max-width: 380px;
        text-align: center; box-shadow: 0 40px 80px rgba(0,0,0,1);
        transform: scale(0.95); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    #hybrid-auth-modal.visible .auth-card { transform: scale(1); }

    .auth-input {
        width: 100%; padding: 14px; margin-bottom: 12px;
        background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
        border-radius: 12px; color: #fff; font-size: 1.1rem; outline: none;
    }
    .auth-input:focus { border-color: #fff; background: rgba(255,255,255,0.1); }

    .auth-btn {
        width: 100%; padding: 14px; margin-top: 10px;
        background: #fff; color: #000; font-weight: 700; border-radius: 99px;
        border: none; cursor: pointer; font-size: 1rem;
    }
    .auth-toggle {
        margin-top: 20px; color: #888; font-size: 0.9rem; cursor: pointer;
    }
    .auth-toggle b { color: #fff; }
    #auth-error { color: #ff4444; font-size: 0.9rem; margin-top: 10px; min-height: 1.2em;}
</style>

<!-- 3. INJECT THE HTML FORM -->
<div id="hybrid-auth-modal">
    <div class="auth-card">
        <h2 style="color:#fff; margin-bottom:10px; font-family:'Inter',sans-serif;">Account Access</h2>
        <p style="color:#888; margin-bottom:20px; font-size:0.9rem;">Enter your details to sync premium status</p>
        <form id="hybrid-form">
            <input type="email" id="h-email" class="auth-input" placeholder="Email" required>
            <input type="password" id="h-password" class="auth-input" placeholder="Password" required>
            <button type="submit" id="h-submit" class="auth-btn">Sign In</button>
        </form>
        <div id="auth-error"></div>
        <div class="auth-toggle" id="h-toggle">New here? <b>Create Account</b></div>
        <div style="margin-top:20px; font-size:0.8rem; color:#444; cursor:pointer;" onclick="closeAuth()">Cancel</div>
    </div>
</div>

<!-- 4. THE MASTER HYBRID LOGIC -->
<!-- 4. THE MASTER HYBRID LOGIC (FIXED) -->
<script>
(async function() {
    // ============================================================
    // 1. SUPABASE CONFIGURATION
    // ============================================================
    const SUPABASE_URL = 'https://csuyapzneytubzdrdegl.supabase.co'; 
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNzdXlhcHpuZXl0dWJ6ZHJkZWdsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3MzM1MzMsImV4cCI6MjA4NTMwOTUzM30.m5lhtxB-9Wutmt1E-3mlO8R0KlgE8YNXaPP1_UJF2k0';
    // ============================================================

    // Initialize Supabase
    let supabase;
    try {
        const { createClient } = window.supabase;
        supabase = createClient(SUPABASE_URL, SUPABASE_KEY);
    } catch (e) {
        console.error("Supabase failed to load. Check your internet or keys.");
    }

    // --- DOM Elements ---
    const premiumLayer = document.getElementById('premium-landing');
    const islandSearch = document.getElementById('island-search-wrapper');
    const body = document.body;
    const authModal = document.getElementById('hybrid-auth-modal');
    const authForm = document.getElementById('hybrid-form');
    const authError = document.getElementById('auth-error');
    const toggleBtn = document.getElementById('h-toggle');
    const submitBtn = document.getElementById('h-submit');
    
    // Animation Elements
    const premiumContent = document.querySelector('.premium-content');
    const premiumProcessing = document.querySelector('.premium-processing');
    const statusText = document.getElementById('premium-status');
    const footer = document.querySelector('.premium-footer');

    // State
    let isSignUp = false;

    // --- HELPER: Toggle Island ---
    const toggleIsland = (hide) => {
        if (!islandSearch) return;
        const style = islandSearch.style;
        if (hide) {
            style.setProperty('display', 'none', 'important');
            style.setProperty('visibility', 'hidden', 'important');
            style.setProperty('opacity', '0', 'important');
            style.setProperty('z-index', '-1', 'important');
        } else {
            style.removeProperty('display');
            style.removeProperty('visibility');
            style.removeProperty('opacity');
            style.removeProperty('z-index');
        }
    };

    // --- HELPER: Unlock The Site (The "Success" State) ---
    const unlockSite = () => {
        if (premiumLayer) premiumLayer.remove();
        document.body.classList.remove('premium-lockdown');
        toggleIsland(false);
        window.dispatchEvent(new Event('resize'));
    };

    // Make functions global for inline onclicks
    window.closeAuth = () => {
        authModal.style.display = 'none';
        authModal.classList.remove('visible');
    };

    // --- 2. CHECK SESSION (Real Database Check) ---
    const { data: { session } } = await supabase.auth.getSession();

    if (session) {
        unlockSite();
        return; 
    } else {
        if (premiumLayer) premiumLayer.style.display = 'flex';
        body.classList.add('premium-lockdown');
        toggleIsland(true);
    }

    // --- 3. CURRENCY LOGIC (Preserved) ---
    const currencyMap = {
        'AF': 'AFN', 'AL': 'ALL', 'DZ': 'DZD', 'AD': 'EUR', 'AO': 'AOA', 'AG': 'XCD', 'AR': 'ARS', 'AM': 'AMD', 'AU': 'AUD', 'AT': 'EUR', 'AZ': 'AZN',
        'BS': 'BSD', 'BH': 'BHD', 'BD': 'BDT', 'BB': 'BBD', 'BY': 'BYN', 'BE': 'EUR', 'BZ': 'BZD', 'BJ': 'XOF', 'BT': 'BTN', 'BO': 'BOB', 'BA': 'BAM', 'BW': 'BWP', 'BR': 'BRL', 'BN': 'BND', 'BG': 'BGN', 'BF': 'XOF', 'BI': 'BIF',
        'CV': 'CVE', 'KH': 'KHR', 'CM': 'XAF', 'CA': 'CAD', 'CF': 'XAF', 'TD': 'XAF', 'CL': 'CLP', 'CN': 'CNY', 'CO': 'COP', 'KM': 'KMF', 'CG': 'XAF', 'CD': 'CDF', 'CR': 'CRC', 'CI': 'XOF', 'HR': 'EUR', 'CU': 'CUP', 'CY': 'EUR', 'CZ': 'CZK',
        'DK': 'DKK', 'DJ': 'DJF', 'DM': 'XCD', 'DO': 'DOP',
        'EC': 'USD', 'EG': 'EGP', 'SV': 'USD', 'GQ': 'XAF', 'ER': 'ERN', 'EE': 'EUR', 'SZ': 'SZL', 'ET': 'ETB',
        'FJ': 'FJD', 'FI': 'EUR', 'FR': 'EUR', 'FM': 'USD',
        'GA': 'XAF', 'GM': 'GMD', 'GE': 'GEL', 'DE': 'EUR', 'GH': 'GHS', 'GR': 'EUR', 'GD': 'XCD', 'GT': 'GTQ', 'GN': 'GNF', 'GW': 'XOF', 'GY': 'GYD',
        'HT': 'HTG', 'HN': 'HNL', 'HU': 'HUF',
        'IS': 'ISK', 'IN': 'INR', 'ID': 'IDR', 'IR': 'IRR', 'IQ': 'IQD', 'IE': 'EUR', 'IL': 'ILS', 'IT': 'EUR',
        'JM': 'JMD', 'JP': 'JPY', 'JO': 'JOD',
        'KZ': 'KZT', 'KE': 'KES', 'KI': 'AUD', 'KP': 'KPW', 'KR': 'KRW', 'KW': 'KWD', 'KG': 'KGS',
        'LA': 'LAK', 'LV': 'EUR', 'LB': 'LBP', 'LS': 'LSL', 'LR': 'LRD', 'LY': 'LYD', 'LI': 'CHF', 'LT': 'EUR', 'LU': 'EUR', 'LC': 'XCD',
        'MG': 'MGA', 'MW': 'MWK', 'MY': 'MYR', 'MV': 'MVR', 'ML': 'XOF', 'MT': 'EUR', 'MH': 'USD', 'MR': 'MRU', 'MU': 'MUR', 'MX': 'MXN', 'MD': 'MDL', 'MC': 'EUR', 'MN': 'MNT', 'ME': 'EUR', 'MA': 'MAD', 'MZ': 'MZN', 'MM': 'MMK',
        'NA': 'NAD', 'NR': 'AUD', 'NP': 'NPR', 'NL': 'EUR', 'NZ': 'NZD', 'NI': 'NIO', 'NE': 'XOF', 'NG': 'NGN', 'MK': 'MKD', 'NO': 'NOK',
        'OM': 'OMR', 'PK': 'PKR', 'PW': 'USD', 'PA': 'USD', 'PG': 'PGK', 'PY': 'PYG', 'PE': 'PEN', 'PH': 'PHP', 'PL': 'PLN', 'PT': 'EUR',
        'QA': 'QAR', 'RO': 'RON', 'RU': 'RUB', 'RW': 'RWF', 'KN': 'XCD', 'VC': 'XCD', 'WS': 'WST', 'SM': 'EUR', 'ST': 'STN', 'SA': 'SAR', 'SN': 'XOF', 'RS': 'RSD', 'SC': 'SCR', 'SL': 'SLE', 'SG': 'SGD', 'SK': 'EUR', 'SI': 'EUR', 'SB': 'SBD', 'SO': 'SOS', 'ZA': 'ZAR', 'SS': 'SSP', 'ES': 'EUR', 'LK': 'LKR', 'SD': 'SDG', 'SR': 'SRD', 'SE': 'SEK', 'CH': 'CHF', 'SY': 'SYP',
        'TJ': 'TJS', 'TZ': 'TZS', 'TH': 'THB', 'TL': 'USD', 'TG': 'XOF', 'TO': 'TOP', 'TT': 'TTD', 'TN': 'TND', 'TR': 'TRY', 'TM': 'TMT', 'TV': 'AUD',
        'UG': 'UGX', 'UA': 'UAH', 'AE': 'AED', 'GB': 'GBP', 'US': 'USD', 'UY': 'UYU', 'UZ': 'UZS',
        'VU': 'VUV', 'VE': 'VES', 'VN': 'VND', 'YE': 'YER', 'ZM': 'ZMW', 'ZW': 'ZWG', 'HK': 'HKD', 'TW': 'TWD', 'PS': 'ILS', 'XK': 'EUR'
    };

    const resolveCurrency = () => {
        let detected = 'USD';
        fetch('https://ipapi.co/json/').then(r=>r.json()).then(d=>{
            if(d.country_code && currencyMap[d.country_code]) paintUI(currencyMap[d.country_code]);
        }).catch(()=>{});
        return detected;
    };

    const paintUI = (currencyCode) => {
        try {
            const formatter = new Intl.NumberFormat(navigator.language, { style: 'currency', currency: currencyCode, minimumFractionDigits: 2 });
            const priceTag = document.querySelector('.price-big');
            if (priceTag) priceTag.innerText = formatter.format(0);
        } catch (e) {
            const priceTag = document.querySelector('.price-big');
            if (priceTag) priceTag.innerText = currencyCode + " 0";
        }
        const legalText = document.querySelector('.premium-legal-disclaimer');
        if (legalText) {
            legalText.innerHTML = legalText.innerHTML.replace(/\b(USD)\b/g, currencyCode);
        }
    };
    paintUI('USD');

    // --- 4. BUTTON INTERCEPTOR ---
    const startBtn = document.getElementById('premium-start-btn');
    if (startBtn) {
        startBtn.addEventListener('click', function() {
            authModal.style.display = 'flex';
            setTimeout(() => authModal.classList.add('visible'), 10);
        });
    }

    // --- 5. AUTH LOGIC (CORRECTED - SINGLE EVENT LISTENER) ---
    toggleBtn.addEventListener('click', () => {
        isSignUp = !isSignUp;
        // Logic flipped: If isSignUp is true, show "Create Account" on button
        submitBtn.innerText = isSignUp ? "Create Account" : "Sign In";
        toggleBtn.innerHTML = isSignUp ? "Have an account? <b>Sign In</b>" : "New here? <b>Create Account</b>";
        authError.innerText = "";
    });

    authForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const email = document.getElementById('h-email').value;
        const password = document.getElementById('h-password').value;
        const currentURL = window.location.origin; // For redirect

        submitBtn.disabled = true;
        submitBtn.innerText = "Processing...";
        authError.innerText = "";

        try {
            let error;
            if (isSignUp) {
                // SIGN UP
                const res = await supabase.auth.signUp({ 
                    email: email, 
                    password: password,
                    options: { emailRedirectTo: currentURL }
                });
                error = res.error;
                
                if (!error) {
                    if (res.data.user && !res.data.session) {
                        authError.style.color = '#4dff88';
                        authError.innerText = "Success! Please check email to confirm.";
                        submitBtn.innerText = "Email Sent";
                        return; 
                    }
                }
            } else {
                // SIGN IN
                const res = await supabase.auth.signInWithPassword({ email, password });
                error = res.error;
            }

            if (error) throw error;

            // --- SUCCESS FLOW ---
            closeAuth();
            
            if (premiumContent) premiumContent.classList.add('content-hidden');
            if (footer) footer.classList.remove('footer-reveal'); 
            if (premiumProcessing) premiumProcessing.classList.add('active');

            const steps = [
                { msg: "Verifying credentials...", delay: 1000 },
                { msg: "Syncing profile data...", delay: 2000 },
                { msg: "Unlocking library...", delay: 3000 }
            ];

            steps.forEach(step => {
                setTimeout(() => { if (statusText) statusText.innerText = step.msg; }, step.delay);
            });

            setTimeout(() => {
                if (premiumLayer) premiumLayer.classList.add('premium-hidden');
                setTimeout(() => {
                    unlockSite();
                }, 800); 
            }, 4500); 

        } catch (err) {
            authError.style.color = '#ff4444';
            authError.innerText = err.message;
            submitBtn.disabled = false;
            submitBtn.innerText = isSignUp ? "Create Account" : "Sign In";
        }
    });

    // --- 6. ANTI-TAMPER ---
    const antiTamper = new MutationObserver((mutations) => {
        const landing = document.getElementById('premium-landing');
        if (!document.body.classList.contains('premium-lockdown')) return;
        if (!landing) { window.location.reload(); return; }
        if (landing.style.display === 'none' || landing.style.opacity === '0' || landing.style.visibility === 'hidden') {
             landing.setAttribute('style', 'display: flex !important; opacity: 1 !important; visibility: visible !important;');
        }
    });
    antiTamper.observe(document.documentElement, {
        childList: true, attributes: true, subtree: true, attributeFilter: ['class', 'style']
    });

})();
</script>
</body>
</html>